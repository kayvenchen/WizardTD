<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Tower.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">WizardTD</a> &gt; <a href="index.source.html" class="el_package">WizardTD</a> &gt; <span class="el_source">Tower.java</span></div><h1>Tower.java</h1><pre class="source lang-java linenums">package WizardTD;

import processing.core.PApplet;
import processing.core.PImage;
import java.util.*;


/**
 * The Tower class represents a tower. Towers are used to defend against 
 * monsters by shooting fireballs. Towers can be upgraded to improve 
 * their range, firing speed, and damage.
 */
public class Tower {
    private int towerCost;
    private int initialTowerRange;
    private double initialTowerFiringSpeed;
    private int initialTowerDamage;

    private int rangeLevel;
    private int speedLevel;
    private int damageLevel;

    private PImage[] towerImages;
    private int towerImageIndex;

    ArrayList&lt;Monster&gt; monsters;
    ArrayList&lt;Fireball&gt; fireballs;

    private long lastFireTime; 
    
    private int x;
    private int y;

    /**
     * Creates a new Tower instance with the specified attributes.
     *
     * @param towerImages           An array of tower images for different upgrade levels.
     * @param towerCost             The initial cost of the tower.
     * @param TowerRange            The initial range of the tower.
     * @param TowerFiringSpeed      The initial firing speed of the tower.
     * @param initialTowerDamage    The initial damage of the tower.
     */
<span class="fc" id="L43">    public Tower(PImage[] towerImages, int towerCost, int TowerRange, double TowerFiringSpeed, int initialTowerDamage) {</span>
<span class="fc" id="L44">        this.towerCost = towerCost;</span>
<span class="fc" id="L45">        this.towerImages = towerImages;</span>
<span class="fc" id="L46">        this.initialTowerRange = TowerRange;</span>
<span class="fc" id="L47">        this.initialTowerFiringSpeed = TowerFiringSpeed;</span>
<span class="fc" id="L48">        this.initialTowerDamage = initialTowerDamage;</span>
<span class="fc" id="L49">    }</span>

    /**
     * Creates a new Tower instance by copying an existing tower and placing it
     * at a specific position.
     *
     * @param original The original Tower instance to be copied.
     * @param x        The X-coordinate of the tower's position.
     * @param y        The Y-coordinate of the tower's position.
     */
<span class="fc" id="L59">    public Tower(Tower original, int x, int y) {</span>
<span class="fc" id="L60">        this.x = x;</span>
<span class="fc" id="L61">        this.y = y;</span>

<span class="fc" id="L63">        this.towerImageIndex = 0;</span>
<span class="fc" id="L64">        this.towerImages = original.towerImages;</span>
<span class="fc" id="L65">        this.towerCost = original.towerCost;</span>
<span class="fc" id="L66">        this.initialTowerRange = original.initialTowerRange;</span>
<span class="fc" id="L67">        this.initialTowerFiringSpeed = original.initialTowerFiringSpeed;</span>
<span class="fc" id="L68">        this.initialTowerDamage = original.initialTowerDamage;</span>

<span class="fc" id="L70">        this.rangeLevel = 0;</span>
<span class="fc" id="L71">        this.speedLevel = 0;</span>
<span class="fc" id="L72">        this.damageLevel = 0;</span>
<span class="fc" id="L73">    }</span>

    /**
     * Gets the X-coordinate of the tower's position on the game grid.
     *
     * @return The X-coordinate of the tower.
     */
    public int getX() {
<span class="nc" id="L81">        return x;</span>
    }

    /**
     * Gets the Y-coordinate of the tower's position on the game grid.
     *
     * @return The Y-coordinate of the tower.
     */
    public int getY() {
<span class="nc" id="L90">        return y;</span>
    }

    /**
     * Upgrades the tower's range. This method increases the tower's effective range.
     */
    public void upgradeRange() {
<span class="nc" id="L97">        rangeLevel++;</span>
<span class="nc" id="L98">    }</span>

    /**
     * Upgrades the tower's firing speed. This method increases the tower's firing rate.
     */
    public void upgradeSpeed() {
<span class="nc" id="L104">        speedLevel++;</span>
<span class="nc" id="L105">    }</span>

    /**
     * Upgrades the tower's damage. This method increases the tower's damage output.
     */
    public void upgradeDamage() {
<span class="nc" id="L111">        damageLevel++;</span>
<span class="nc" id="L112">    }</span>

    /**
     * Gets the current upgrade level of the tower's range.
     *
     * @return The range upgrade level.
     */
    public int getRangeLevel() {
<span class="nc" id="L120">        return rangeLevel;</span>
    }

    /**
     * Gets the current upgrade level of the tower's firing speed.
     *
     * @return The firing speed upgrade level.
     */
    public int getSpeedLevel() {
<span class="nc" id="L129">        return speedLevel;</span>
    }

    /**
     * Gets the current upgrade level of the tower's damage.
     *
     * @return The damage upgrade level.
     */
    public int getDamageLevel() {
<span class="nc" id="L138">        return damageLevel;</span>
    }

    /**
     * Calculates the cost of upgrading a particular attribute (range, speed, or damage)
     * to a specified level.
     *
     * @param level The desired upgrade level.
     * @return The cost of upgrading to the specified level.
     */
    public int getUpgradeCost(int level) {
<span class="nc" id="L149">        return 20 + (10 * level);</span>
    }

    /**
     * Gets the initial cost of the tower.
     *
     * @return The initial cost of the tower.
     */
    public int getTowerCost() {
<span class="nc" id="L158">        return towerCost;</span>
    }

    /**
     * Gets the effective range of the tower, taking into account range upgrades.
     *
     * @return The effective range of the tower.
     */
    public int getRange() {
<span class="nc" id="L167">        return initialTowerRange + (32 * (rangeLevel));</span>
    }

    /**
     * Gets the firing speed of the tower, taking into account speed upgrades.
     *
     * @return The effective firing speed of the tower.
     */
    public double getFiringSpeed() {
<span class="nc" id="L176">        return initialTowerFiringSpeed + (0.5 * (speedLevel));</span>
    }

    /**
     * Gets the tower's damage output, taking into account damage upgrades.
     *
     * @return The effective damage output of the tower.
     */
    public int getDamage() {
<span class="nc" id="L185">        return initialTowerDamage + (initialTowerDamage / 2) * (damageLevel);</span>
    }

    /**
     * Calculates the time interval between two consecutive fireball shots by the tower.
     *
     * @return The time interval in milliseconds.
     */
    public double getFireInterval() {
<span class="nc" id="L194">        return 1000 / this.getFiringSpeed();</span>
    }

    /**
     * Gets the timestamp of the last time the tower fired a fireball.
     *
     * @return The timestamp of the last fire.
     */
    public long getLastFireTime() {
<span class="nc" id="L203">        return lastFireTime;</span>
    }

    /**
     * Sets the timestamp of the last time the tower fired a fireball.
     *
     * @param lastFireTime The timestamp of the last fire.
     */
    public void setLastFireTime(long lastFireTime) {
<span class="nc" id="L212">        this.lastFireTime = lastFireTime;</span>
<span class="nc" id="L213">    }</span>

    /**
     * Sets the tower's current image index to control its appearance based on upgrades.
     *
     * @param towerImageIndex The image index to set.
     */
    public void setTowerImageIndex(int towerImageIndex) {
<span class="nc" id="L221">        this.towerImageIndex = towerImageIndex;</span>
<span class="nc" id="L222">    }</span>

    /**
     * Draws the tower on the game screen with its current appearance and upgrades.
     *
     * @param app The PApplet instance for rendering.
     */
    public void draw(PApplet app) {
<span class="nc" id="L230">        int xOffset = this.x * App.CELLSIZE;</span>
<span class="nc" id="L231">        int yOffset = this.y * App.CELLSIZE + App.TOPBAR;</span>
        
        // set tower image
<span class="nc bnc" id="L234" title="All 6 branches missed.">        if (rangeLevel &gt;= 2 &amp;&amp; speedLevel &gt;= 2 &amp;&amp; damageLevel &gt;= 2) {</span>
<span class="nc" id="L235">            this.towerImageIndex = 2;</span>
<span class="nc bnc" id="L236" title="All 6 branches missed.">        } else if (rangeLevel &gt;= 1 &amp;&amp; speedLevel &gt;= 1 &amp;&amp; damageLevel &gt;= 1) {</span>
<span class="nc" id="L237">            this.towerImageIndex = 1;</span>
        } else {
<span class="nc" id="L239">            this.towerImageIndex = 0;</span>
        }


<span class="nc" id="L243">        app.image(this.towerImages[towerImageIndex], xOffset, yOffset);</span>

<span class="nc bnc" id="L245" title="All 2 branches missed.">        if (speedLevel-towerImageIndex &gt; 0) {</span>
<span class="nc" id="L246">            app.stroke(136, 179, 249);  // Set fill color to blue</span>
<span class="nc" id="L247">            app.noFill();</span>
            // Calculate the border thickness based on speedLevel
<span class="nc" id="L249">            int borderThickness = 1 + speedLevel;  // Adjust the thickness as needed</span>
<span class="nc" id="L250">            app.strokeWeight(borderThickness);</span>
            // Draw the border
<span class="nc" id="L252">            app.rect(xOffset+6, yOffset+6, this.towerImages[towerImageIndex].height-12, this.towerImages[towerImageIndex].width-12);</span>
        }
        
<span class="nc bnc" id="L255" title="All 2 branches missed.">        for (int i = 0; i &lt; rangeLevel-towerImageIndex; i++) {</span>
<span class="nc" id="L256">            int xPosition = xOffset + i * 5;  // Alternate x position</span>
<span class="nc" id="L257">            app.fill(227, 77, 239);  // Fill color (black)</span>
<span class="nc" id="L258">            app.textSize(10); // Text size</span>
<span class="nc" id="L259">            app.text(&quot;o&quot;, xPosition, yOffset + 5);</span>
        }

<span class="nc bnc" id="L262" title="All 2 branches missed.">        for (int i = 0; i &lt; damageLevel-towerImageIndex; i++) {</span>
<span class="nc" id="L263">            int xPosition = xOffset + i * 5;  // Alternate x position</span>
<span class="nc" id="L264">            app.fill(227, 77, 239);  // Fill color (black)</span>
<span class="nc" id="L265">            app.textSize(10); // Text size</span>
<span class="nc" id="L266">            app.text(&quot;x&quot;, xPosition, yOffset + this.towerImages[towerImageIndex].height);</span>
        }
<span class="nc" id="L268">    }  </span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>